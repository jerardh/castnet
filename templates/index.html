<!DOCTYPE html>
<html>
<head>
    <title>CastNet</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function addCharacterField(value="") {
            const container = document.getElementById("character-container");

            const div = document.createElement("div");
            div.className = "char-block";

            div.innerHTML = `
                <textarea name="character_description[]" rows="2" required placeholder="Describe character...">${value}</textarea>
                <button type="button" onclick="removeCharacterField(this)">âŒ</button>
            `;

            container.appendChild(div);
        }

        function removeCharacterField(btn) {
            btn.parentElement.remove();
        }
    </script>
</head>
<body>

<h2>ğŸ¬ CastNet â€“ Smart Actor Recommendation</h2>

<form method="POST">

    <label>Movie Plot</label>
    <textarea name="plot" rows="4" required>{{ request.form.get('plot', '') }}</textarea>

    <label>Character Descriptions</label>

    <div id="character-container">
        {% if request.form.getlist('character_description[]') %}
            {% for desc in request.form.getlist('character_description[]') %}
                <div class="char-block">
                    <textarea name="character_description[]" rows="2" required>{{ desc }}</textarea>
                    <button type="button" onclick="removeCharacterField(this)">âŒ</button>
                </div>
            {% endfor %}
        {% else %}
            <div class="char-block">
                <textarea name="character_description[]" rows="2" required></textarea>
                <button type="button" onclick="removeCharacterField(this)">âŒ</button>
            </div>
        {% endif %}
    </div>
    <br>
    <button type="button" onclick="addCharacterField()">â• Add Character</button>

    <br><br>

    <label>Preferred Gender</label>
    <select name="gender">
        <option value="">Any</option>
        <option value="male" {% if request.form.get('gender') == 'male' %}selected{% endif %}>Male</option>
        <option value="female" {% if request.form.get('gender') == 'female' %}selected{% endif %}>Female</option>
    </select>

    <label>Preferred Age Group</label>
    <select name="age_group">
        <option value="">Any</option>
        <option value="20-30" {% if request.form.get('age_group') == '20-30' %}selected{% endif %}>20-30</option>
        <option value="30-40" {% if request.form.get('age_group') == '30-40' %}selected{% endif %}>30-40</option>
        <option value="40-50" {% if request.form.get('age_group') == '40-50' %}selected{% endif %}>40-50</option>
        <option value="60+" {% if request.form.get('age_group') == '60+' %}selected{% endif %}>60+</option>
    </select>

    <br>
    <button type="submit">ğŸ¯ Get Actor Suggestions</button>
</form>

{% if results %}
<div class="results">
    <h3>ğŸ­ Recommended Actors</h3>

    {% for row in results %}
    <div class="actor-card">
        <div class="actor-name">{{ row.actor_name }}</div>
        <div class="meta">ğŸ¬ Movie: {{ row.movie_name }}</div>
        <div class="meta">ğŸ­ Role: {{ row.character_name }}</div>
        <div class="meta">ğŸ‘¤ Gender: {{ row.gender }}</div>
        <div class="meta">ğŸ‚ Age Group: {{ row.age_group }}</div>
    </div>
    {% endfor %}
</div>

{% elif request.method == "POST" %}
<div class="results">
    <h3>âš ï¸ No matching actors found</h3>
    <p>Try changing age group, gender, or description.</p>
</div>
{% endif %}

</body>
</html>
